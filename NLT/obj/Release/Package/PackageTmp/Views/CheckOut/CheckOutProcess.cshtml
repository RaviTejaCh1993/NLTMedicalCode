
@{
    ViewBag.Title = "CheckOutProcess";
    Layout = "~/Views/Shared/_LayoutMasterClient.cshtml";
}


@model  NLT.Models.CPModel

<h2>CheckOutProcess</h2>

@*@model  IEnumerable<NLT.Models.CheckoutProcessModel>*@
<script src="~/Scripts/jquery-1.11.3.min.js"></script>

@*<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<link rel="stylesheet" href="/resources/demos/style.css">
<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>*@

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6/jquery.min.js" type="text/javascript"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js" type="text/javascript"></script>
<link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css" rel="Stylesheet" type="text/css" />

<script>
  $( function() {
    $( "#datepicker" ).datepicker();
  } );
</script>

@using (Html.BeginForm("Index", "Checkout", FormMethod.Post))
{
    <caption align="right">
        <a class="btnNearestPrice" href="/User/Test" style="color:blue;">Add another test</a>
    </caption>
   
    <div class="container body" style="padding:20px;">
        
        <div class="col-sm-6">

            @*<div class="row headding" style="display:none">
                    @Html.TextBoxFor(Model => Model.LocationId, "", new { Id = "LocationId", @readonly = "readonly" })
                </div>

                <div class="row headding" style="display:none">
                    @Html.TextBoxFor(Model => Model.TestId, "", new { Id = "TestId", @readonly = "readonly" })
                </div>*@

            <div class="row headding">
                
                <div class="col-sm-6">
                    <div class="title">YOUR CENTER</div>
                </div>
                <div class="col-sm-2" style="float:left">
                    <div class="title">Test</div>
                </div>
                <div class="col-sm-2" style="float:left">
                    <div class="title">MRP</div>
                </div>
            </div>
            <div class="row footlable">
                <table class="table table-responsive">

                    @{ decimal SubTotal = 0; int sequenceNumber = 0; }
                @foreach (var a in Model.Tests)
                {         
                           sequenceNumber = (Convert.ToInt32(sequenceNumber) + 1);
                        <tr>
                            <td>
                                @sequenceNumber
                            </td>
                            <td>
                                @a.CompanyName
                            </td>
                            <td>
                                @a.TestName

                            </td>
                            <td>
                                @a.MRP
                            </td>
                        </tr>

                         SubTotal = (Convert.ToDecimal(SubTotal) + Convert.ToDecimal(a.MRP));

                        @*<div class="col-sm-6">@a.CompanyName</div>*@


                        @*<div class="row footlable" style="float:left">
                                <div class="col-sm-2">@a.TestName</div>
                            </div>
                            <div class="row footlable" style="float:left">
                                <div class="col-sm-2">@a.MRP</div>
                            </div>*@
                }


                    <tr>
                        <td></td>
                        <td>
                            
                        </td>
                       
                        <td>
                         Sub Total :

                        </td>
                        <td>
                            @SubTotal
                        </td>
                    </tr>
                    <tr style="background-color:#f1fcfa">
                        <td></td>
                        <td></td>
                        <td>
                            Total :
                        </td>
                        <td>
                            @SubTotal
                        </td>
                    </tr>
                </table>
            </div>

            @*@foreach (var a in Model)
            {


                <div class="row footlable">
                    <div class="col-sm-8">@a.TestName</div>
                </div>
                <div class="row">
                    <div class="col-sm-8" style="height:20px;"></div>
                </div>

                <div class="row headding">
                    <div class="col-sm-8">
                        <div class="title">YOUR Tests</div>
                    </div>
                </div>

                <div>
                    <div class="row">
                        <div class="col-sm-8 footlable">@Model.TestName</div>
                            <div class="col-sm-4 footlable"> ₹ @Model.Amount</div>
                    </div>
                </div>

            }*@



            <div>
                @*<div class="row">
                        <div class="col-sm-8 footlable">@Model.TestName</div>
                        <div class="col-sm-4 footlable"> ₹ @Model.Amount</div>
                    </div>*@

                @*<div class="row padd-10 headding">
                        <div class="col-sm-8">Subtotal:</div>
                        <div class="col-sm-4"> ₹ @Model.Amount</div>
                    </div>
                    <u></u>
                    <div class="row padd-10 headding">
                        <div class="col-sm-8">  Order Total:</div>
                        <div class="col-sm-4"> ₹ @Model.Amount</div>
                    </div>*@



            </div>
        </div>
        @*<div class="col-sm-1"></div>*@
        <div class="col-sm-6">

            <div class="row">
                <div class="headding">
                    <div class="col-sm-12"><div class="title">YOUR INFORMATION</div></div>
                </div>
                <div class="footlable" style="height:100px;">
                    <div class="col-sm-5" style="float:left;">
                        <label> Name </label> @*<input type="text" class="form-control" placeholder="Your Name" />*@

                        @Html.TextBoxFor(m => m.YourName, null, new { @class = "txtYourName form-control YourName", @placeholder = "Your Name" })

                    </div>
                    @*<div class="col-sm-3" style="float:left;">

                        </div>*@

                    <div class="col-sm-7" style="float:left;">
                        Phone @*<input type="text" class="form-control" placeholder="Your Mobile Number" />*@
                        @Html.TextBoxFor(m => m.PhoneNumber, null, new { @class = "txtPhoneNumber form-control PhoneNumber", @placeholder = "Your Mobile Number", @onkeypress = "return IsNumeric(event);", @ondrop = "return false;", @onpaste = "return false;", @MaxLength = "10" })
                        @*<input onclick="return validate()" type="submit" value="Next" style="background-color:green;color:white;margin:20px;" class="btnSubmit  btn btn-success" />*@
                    </div>
                    @*<div class="col-sm-1" style="float:left;">
                        
                    </div>*@

                </div>
            </div>

            <div class="row">
                <div class="headding">
                    <div class="col-sm-12">
                        <div class="title">Who are these tests for?</div>
                    </div>
                </div>
                <div class="footlable" style="height:100px;">
                    <div class="col-sm-5" style="float:left;">
                        Name  @*<input type="text" class="form-control" placeholder="Person Name" />*@
                        @Html.TextBoxFor(m => m.TestPersonName, null, new { @class = "txtTestPersonName form-control TestPersonName", @placeholder = "Person Name" })
                    </div>


                    <div class="col-sm-6" style="float:left;">
                        Age @*<input type="text" class="form-control" placeholder="Person Age" />*@
                        @*<input type="button" class="btn btn-success" value="Go" />*@
                        @Html.TextBoxFor(m => m.Age, null, new { @class = "txtAge form-control Age", @placeholder = "Age" })

                    </div>
                    <div class="col-sm-1" style="float:left;">

                    </div>

                </div>
                <div class="headding">
                    <div class="col-sm-12">
                        <div class="title">PICK YOUR APPOINTMENT</div>
                    </div>
                </div>
                <div class="footlable" style="height:70px;">
                    @*<div class="col-sm-5" style="float:left;">
                            Appointment Date  <input type="text" class="form-control" placeholder="Pick Date" />

                            <div class="col-md-10">
                                @Html.EditorFor(model => model.BirthDate, new { htmlAttributes = new { @class = "form-control" } })
                                @Html.ValidationMessageFor(model => model.BirthDate, "", new { @class = "text-danger" })
                            </div>

                        </div>*@

                    @*<div class="form-group">
                            @Html.LabelFor(model => model.BirthDate, htmlAttributes: new { @class = "control-label col-md-2" })
                            <div class="col-md-10">
                                @Html.EditorFor(model => model.BirthDate, new { htmlAttributes = new { @class = "form-control" } })
                                @Html.ValidationMessageFor(model => model.BirthDate, "", new { @class = "text-danger" })
                            </div>
                        </div>*@

                    <div class="form-group">
                        @*@Html.LabelFor(m => m.Appointmentdate, new { @class = "col-md-2 control-label" })*@

                        <div class="col-md-10">
                            @*@Html.TextBox("StartDate", string.Empty, new { @class = "datepicker" })*@
                            @*@Html.TextBoxFor(m => m.Appointmentdate, "{0:yyyy-MM-ddThh:mm:ss}", new { @class = "form-control", type = "datetime-local" })*@
                            @*@Html.TextBoxFor(m => m.Appointmentdate,null, new { @class = "datepicker form-control" })*@
                            @*@Html.ValidationMessageFor(m => m.Appointmentdate, "", new { @class = "text-danger" })*@

                            @Html.TextBoxFor(m => m.Appointmentdate, "{0:yyyy-MM-ddThh:mm:ss}", new { @class = "form-control", type = "datetime-local" })


                            @*<p>Date: <input type="text" id="datepicker"></p>*@

                        </div>
                    </div>

                </div>
            </div>

        </div>
        <div>
            <table width="100%">
                <tr>
                    <td width="100%" align="right">
                        <input onclick="return validate()" type="submit" value="Next" style="background-color:green;color:white;margin:20px;" class="btnSubmit  btn btn-success" />
                    </td>
                </tr>
            </table>

        </div>
    </div>

}



<style type="text/css">
    .div1-class1 {
        background-color: white;
        padding: 20px;
    }

    .div2-class1 {
        background-color: #f9fcfc;
        padding: 20px;
    }

    .body {
        font-family: "AvenirNext", "Avenir Next", "Nunito","Open Sans", "OpenSans", "Arial";
        font-weight: 400;
        font-stretch: normal;
        font-size: 14px;
        overflow-y: auto;
        overflow-x: hidden;
        background-color: #fafcfc;
    }

    .headding {
        background-color: #fcc196;
    }

    .footlable {
        background-color: white;
        padding: 15px 10px;
    }

    .padd-10 {
        padding: 10px;
        /*background: #d4cacaab;*/
    }

    .title {
        padding: 15px 10px;
    }
</style>

<script type="text/javascript">
    var specialKeys = new Array();
    specialKeys.push(8); //Backspace
    function IsNumeric(e) {
        var keyCode = e.which ? e.which : e.keyCode
        var ret = ((keyCode >= 48 && keyCode <= 57) || specialKeys.indexOf(keyCode) != -1);
        //document.getElementById("error").style.display = ret ? "none" : "inline";
        return ret;
    }


    function validate() {

        var Erros = "";

        if ($('.PhoneNumber').val() == "") {
            Erros = Erros + " Phone Number is required \n";
        }
        
        if ($('.PhoneNumber').val() != "") {

            var LoginModel = {};

            LoginModel.PhoneNumber = $('.PhoneNumber').val();


            $.ajax({
                type: "POST",
                url: "/CheckOut/PhoneNumberVerify",
                data: '{ LoginModel: ' + JSON.stringify(LoginModel) + '}',
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (response) {

                    if (response.StatusCode == 200) {

                        // alert(response.Result);
                        // window.location.href = '@Url.Action("Encash", "User")';


                    }
                    else
                        if (response.StatusCode == 400) {
                            // alert(response.ErrorMessage);
                            // alert("Error.....");
                            alert(response.ErrorMessage);
                            Erros = Erros + response.ErrorMessage;
                            return false;
                        }
                        else if (response.StatusCode == 500) {
                            alert(response.ErrorMessage);
                            //  alert("Error.....");
                        }
                    // alert("Hello: " + response.Name + ".\nCurrent Date and Time: " + response.DateTime);

                },
                failure: function (response) {
                    alert("Error");
                },
                error: function (response) {
                    alert("Error");
                }
            });


        }
        if ($('.txtYourName').val() == "") {
            Erros = Erros + " Your Name is required \n";
        }

        if ($('.TestPersonName').val() == "") {
            Erros = Erros + " Test Person Name is required \n";
        }
        if ($('.Age').val() == "") {
            Erros = Erros + " Age is required \n";
        }

        if (Erros != "") {
            alert(Erros);

            return false;
        }
        else {
            return true;
        }

    }

</script>

